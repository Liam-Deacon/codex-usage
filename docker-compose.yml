version: '3.8'

services:
  codex-usage:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        - TARGETARCH=amd64
    image: ghcr.io/liam-deacon/codex-usage:latest
    container_name: codex-usage
    volumes:
      - ~/.codex:/home/appuser/.codex:ro
      - ~/.codex-usage:/home/appuser/.codex-usage
    environment:
      - CODEX_USAGE_DIR=/home/appuser/.codex-usage
      - CODEX_USAGE_VERBOSE=${CODEX_USAGE_VERBOSE:-false}
    profiles:
      - run
